<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="admin/fragment/head :: head"></head>
<body class="bg-gray-100 font-sans text-gray-800">

	<header th:replace="admin/fragment/header :: header"></header>

	<div class="flex pt-14 min-h-screen">
		<aside th:replace="admin/fragment/aside :: aside"></aside>

		<main class="flex-1 p-6 pb-12">
			<div class="flex justify-between items-center mb-4">
				<h1 class="text-2xl font-semibold">Quản lý Hot Deals</h1>
				<a th:href="@{/admin/add-hotdeal}"
					class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded">
					+ Thêm mới </a>
			</div>

			<div class="overflow-x-auto bg-white shadow-md rounded-lg">
				<form th:action="@{/admin/hotdeal}" method="get"
					class="grid grid-cols-1 md:grid-cols-5 gap-3 p-4 bg-gray-50 border-b rounded-t-lg">

					<input type="text" name="keyword" th:value="${keyword}"
						placeholder="Tên sản phẩm"
						class="col-span-2 border px-3 py-2 rounded-md focus:ring-2 focus:ring-blue-400" />

					<select name="status"
						class="border px-3 py-2 rounded-md focus:ring-2 focus:ring-blue-400">
						<option value="">Trạng thái</option>
						<option value="1" th:selected="${status == 1}">Hoạt động</option>
						<option value="0" th:selected="${status == 0}">Ẩn</option>
					</select> <input type="date" name="startDate" th:value="${startDate}"
						class="border px-3 py-2 rounded-md focus:ring-2 focus:ring-blue-400" />

					<input type="date" name="endDate" th:value="${endDate}"
						class="border px-3 py-2 rounded-md focus:ring-2 focus:ring-blue-400" />

					<div class="md:col-span-5 text-right">
						<button type="submit"
							class="inline-block bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded-md shadow">
							<i class="fa fa-filter mr-1"></i> Lọc
						</button>
					</div>
				</form>

				<table class="min-w-full divide-y divide-gray-200 text-sm text-left">
					<thead class="bg-slate-100 text-gray-700 uppercase text-xs">
						<tr>
							<th class="px-4 py-3">#</th>
							<th class="px-4 py-3">Sản phẩm</th>
							<th class="px-4 py-3">Ảnh</th>
							<th class="px-4 py-3 text-right">Giá gốc</th>
							<th class="px-4 py-3 text-center">Giảm</th>
							<th class="px-4 py-3 text-right">Giá sau giảm</th>
							<th class="px-4 py-3">Từ ngày</th>
							<th class="px-4 py-3">Đến ngày</th>
							<th class="px-4 py-3 text-center">Trạng thái</th>
							<th class="px-4 py-3 text-center">Hành động</th>
						</tr>
					</thead>
					<tbody class="divide-y divide-gray-100 bg-white"
						th:each="deal, iterStat : ${hotDeals}">
						<tr class="hover:bg-gray-50 transition">
							<td class="px-4 py-2 text-gray-600" th:text="${iterStat.count}"></td>
							<td class="px-4 py-2 font-medium text-gray-800"
								th:text="${deal.product != null ? deal.product.name : 'NULL'}"></td>
							<td class="px-4 py-2"><img
								th:src="@{'/uploads/' + ${deal.product.image}}" alt="Ảnh"
								class="w-12 h-12 object-cover rounded" /></td>
							<td class="px-4 py-2 text-right text-gray-700"
								th:text="${#numbers.formatDecimal(deal.product.price, 0, 'POINT', 0, 'COMMA')} + ' ₫'"></td>
							<td class="px-4 py-2 text-center text-rose-600 font-semibold"
								th:text="${deal.discountPercent + '%'}"></td>
							<td class="px-4 py-2 text-right font-semibold text-emerald-600"
								th:text="${#numbers.formatDecimal(deal.product.price * (1 - deal.discountPercent / 100.0), 0, 'POINT', 0, 'COMMA')} + ' ₫'"></td>
							<td class="px-4 py-2"
								th:text="${#temporals.format(deal.startDate, 'dd/MM/yyyy')}"></td>
							<td class="px-4 py-2"
								th:text="${#temporals.format(deal.endDate, 'dd/MM/yyyy')}"></td>
							<td class="px-4 py-2 text-center"><span
								class="inline-block px-2 py-1 text-xs font-bold rounded-full"
								th:classappend="${deal.status == 1 ? 'bg-green-100 text-green-700' : 'bg-red-100 text-red-700'}"
								th:text="${deal.status == 1 ? 'Hoạt động' : 'Ẩn'}"></span></td>
							<td class="px-4 py-2 text-center"><a
								th:href="@{'/admin/edit-hotdeal/' + ${deal.id}}"
								class="text-indigo-600 hover:text-indigo-900 mr-2"> <i
									class="fa fa-edit"></i> Sửa
							</a> <a th:href="@{'/admin/delete-hotdeal/' + ${deal.id}}"
								onclick="return confirm('Xác nhận xoá deal này?')"
								class="text-red-600 hover:text-red-800"> <i
									class="fa fa-trash-alt"></i> Xoá
							</a></td>
						</tr>
					</tbody>
				</table>

				<!-- Pagination -->
				<div class="mt-6 mb-8 flex justify-center">
					<nav th:if="${totalPages > 1}">
						<ul class="inline-flex space-x-1">
							<li th:each="i : ${#numbers.sequence(0, totalPages - 1)}"><a
								th:href="@{'/admin/hotdeal?page=' + ${i}}" th:text="${i + 1}"
								th:classappend="${i == currentPage} ? 'bg-blue-600 text-white' : 'bg-white text-gray-800'"
								class="px-3 py-1 border rounded shadow hover:bg-gray-100 transition duration-150 ease-in-out">
							</a></li>
						</ul>
					</nav>
				</div>
			</div>

			<div th:replace="admin/fragment/footer :: footer"></div>
		</main>
	</div>

	<div th:replace="admin/fragment/script :: script"></div>
</body>
</html>
